<script>
  (async () => {
    const GOOGLE_URL = `https://google.com/search?q=`;
    let searchQuery = window.location.search;
    let redirect = await fetch(
      `/.netlify/functions/rusty-bunny-rs${window.location.search}`
    ).then(async (val) => await val.text());
    if (redirect) {
      try {
        new URL(redirect);
        window.location.replace(redirect);
      } catch (_) {
        // invalid redirect_url
        window.location.replace(`${GOOGLE_URL}${searchQuery}`);
        return false;
      }
    }
  })();
</script>
